import{r as n,j as e,p as o,q as p}from"./index-DCjzbjsf.js";const g=()=>{const[d,l]=n.useState(""),[s,x]=n.useState(null),m=()=>{if(!d)return;const i=d.split(`
`),r={from:"",to:"",subject:"",date:"",returnPath:"",received:[],spf:"",dkim:"",dmarc:"",spamScore:"",contentType:""};i.forEach(a=>{var c;const t=a.toLowerCase();t.startsWith("from:")&&(r.from=a.substring(5).trim()),t.startsWith("to:")&&(r.to=a.substring(3).trim()),t.startsWith("subject:")&&(r.subject=a.substring(8).trim()),t.startsWith("date:")&&(r.date=a.substring(5).trim()),t.startsWith("return-path:")&&(r.returnPath=a.substring(12).trim()),t.startsWith("received:")&&r.received.push(a.substring(9).trim()),t.includes("spf=")&&(r.spf=a),t.includes("dkim-signature")&&(r.dkim="Present"),t.includes("dmarc")&&(r.dmarc=a),(t.includes("spam-score")||t.includes("x-spam-score"))&&(r.spamScore=(c=a.split(":")[1])==null?void 0:c.trim()),t.startsWith("content-type:")&&(r.contentType=a.substring(13).trim())}),x(r)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Paste Email Header"}),e.jsx("textarea",{value:d,onChange:i=>l(i.target.value),className:"w-full h-64 p-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500 outline-none resize-none font-mono text-xs",placeholder:"Paste raw email headers here..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:m,className:"px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-colors flex items-center space-x-2",children:[e.jsx(o,{size:18}),e.jsx("span",{children:"Analyze Header"})]})}),s&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[e.jsx(p,{size:18}),e.jsx("span",{children:"Analysis Report"})]})}),e.jsxs("div",{className:"p-6 grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Subject"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.subject||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"From"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white break-all",children:s.from||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"To"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white break-all",children:s.to||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.date||"N/A"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Return Path"}),e.jsx("p",{className:"font-mono text-sm text-gray-900 dark:text-white break-all",children:s.returnPath||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Security Checks"}),e.jsxs("div",{className:"space-y-1 mt-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"SPF:"}),e.jsx("span",{className:s.spf?"text-green-600 dark:text-green-400":"text-gray-400",children:s.spf?"Found":"Not Found"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"DKIM:"}),e.jsx("span",{className:s.dkim?"text-green-600 dark:text-green-400":"text-gray-400",children:s.dkim?"Found":"Not Found"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"DMARC:"}),e.jsx("span",{className:s.dmarc?"text-green-600 dark:text-green-400":"text-gray-400",children:s.dmarc?"Found":"Not Found"})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Spam Score"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.spamScore||"N/A"})]})]})]}),s.received.length>0&&e.jsxs("div",{className:"px-6 pb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2",children:"Routing Hops (Received)"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg text-xs font-mono text-gray-600 dark:text-gray-400 space-y-2 max-h-40 overflow-y-auto",children:s.received.map((i,r)=>e.jsxs("div",{className:"break-all border-b border-gray-200 dark:border-gray-800 last:border-0 pb-1 last:pb-0",children:[r+1,". ",i]},r))})]})]})]})};export{g as default};
